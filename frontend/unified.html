<!-- PRIMARY: Unified Command Center -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TRITIUM-SC Command Center</title>
    <meta name="description" content="TRITIUM-SC Command Center - Real-time tactical battlefield management">
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><rect width='100' height='100' rx='12' fill='%230a0a0f'/><rect x='8' y='8' width='84' height='84' rx='8' fill='none' stroke='%2300f0ff' stroke-width='2' opacity='0.6'/><text x='50' y='65' text-anchor='middle' font-family='monospace' font-weight='bold' font-size='40' fill='%2300f0ff'>T</text></svg>">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/static/css/cybercore-v2.css">
    <link rel="stylesheet" href="/static/css/command.css">
    <link rel="stylesheet" href="/static/css/panels.css">
</head>
<body class="v2 grid-bg">

    <!-- ================================================================== -->
    <!-- HEADER BAR (36px)                                                   -->
    <!-- ================================================================== -->
    <header id="header-bar" class="cc-header" data-component="header">
        <div class="header-left cc-header__left">
            <span class="header-logo" data-element="logo">TRITIUM-SC</span>
            <span class="header-separator"></span>
            <button id="mode-indicator" class="mode-badge" data-mode="sim" data-element="mode-indicator">
                <span class="mode-dot"></span>
                <span class="mode-label">SIM</span>
            </button>
        </div>

        <div class="header-center cc-header__center">
            <span id="header-clock" class="header-clock mono" data-element="clock">00:00:00 UTC</span>
            <span class="header-separator"></span>
            <span id="header-units" class="header-stat" data-element="unit-count">
                <span class="stat-dot status-green"></span>
                <span class="stat-value">0</span>
                <span class="stat-label">units</span>
            </span>
            <span class="header-separator"></span>
            <span id="header-threats" class="header-stat" data-element="threat-count">
                <span class="stat-dot status-amber"></span>
                <span class="stat-value">0</span>
                <span class="stat-label">threats</span>
            </span>
        </div>

        <div class="header-right cc-header__right">
            <div id="game-score-area" class="game-score" data-element="game-score" hidden>
                <span class="score-label">WAVE</span>
                <span id="game-wave" class="score-value">0/10</span>
                <span class="score-sep"></span>
                <span class="score-label">SCORE</span>
                <span id="game-score" class="score-value">0</span>
                <span class="score-sep"></span>
                <span class="score-label">ELIMS</span>
                <span id="game-eliminations" class="score-value">0</span>
            </div>
            <span id="connection-status" class="connection-indicator" data-element="connection-status" data-state="disconnected">
                <span class="conn-dot"></span>
                <span class="conn-label mono">OFFLINE</span>
            </span>
        </div>
    </header>

    <!-- ================================================================== -->
    <!-- MAIN: Full-viewport tactical area + panel container                 -->
    <!-- ================================================================== -->
    <main id="main-layout" class="unified-layout" data-component="main-layout">

        <!-- Command Bar (28px toolbar) -->
        <div id="command-bar-container" data-component="command-bar"></div>

        <!-- Tactical Map (Canvas fills entire viewport between header+status) -->
        <div id="tactical-area" class="unified-tactical" data-component="tactical-area">
            <canvas id="tactical-canvas" data-element="tactical-canvas"></canvas>

            <!-- Map mode indicator (top-left of map) -->
            <div id="map-mode" class="map-mode-indicator" data-element="map-mode">
                <button class="map-mode-btn active" data-map-mode="observe">
                    <span class="mono">O</span>BSERVE
                </button>
                <button class="map-mode-btn" data-map-mode="tactical">
                    <span class="mono">T</span>ACTICAL
                </button>
                <button class="map-mode-btn" data-map-mode="setup">
                    <span class="mono">S</span>ETUP
                </button>
            </div>

            <!-- Map coordinates display -->
            <div id="map-coords" class="map-coords mono" data-element="map-coords">
                <span data-coord="x">X: 0.0</span>
                <span data-coord="y">Y: 0.0</span>
            </div>

            <!-- FPS counter -->
            <div id="map-fps" class="map-fps mono" data-element="map-fps">-- FPS</div>

            <!-- Minimap -->
            <div id="minimap-container" class="minimap corner-marks" data-component="minimap">
                <canvas id="minimap-canvas" width="200" height="200" data-element="minimap-canvas"></canvas>
                <div class="minimap-label mono">MINIMAP</div>
            </div>

            <!-- Center-screen banner (announcer: wave banners, kill streaks) -->
            <div id="center-banner" class="center-banner" data-element="center-banner" hidden>
                <div class="banner-text" data-element="banner-text"></div>
                <div class="banner-sub" data-element="banner-sub"></div>
            </div>

            <!-- Combat HUD overlays (populated by war-hud.js) -->
            <div id="war-countdown" class="war-countdown" style="display:none"></div>
            <div id="war-wave-banner" class="war-wave-banner" style="display:none"></div>
            <div id="war-elimination-feed" class="war-elimination-feed"></div>
            <div id="war-score" class="war-score" style="display:none"></div>
            <div id="war-begin-btn" class="war-begin-btn" style="display:none">
                <button class="game-btn game-btn-primary mono" onclick="if(typeof _onBeginWar==='function')_onBeginWar();else if(typeof warHudShowBeginWarButton==='function'){fetch('/api/game/begin',{method:'POST'}).catch(()=>{})}">[ BEGIN WAR ]</button>
            </div>
            <div id="war-game-over" class="war-game-over" style="display:none"></div>
            <div id="war-amy-toast" class="war-announcement" style="opacity:0"></div>
        </div>

        <!-- Floating Panel Container (z:100+, pointer-events:none on container) -->
        <div id="panel-container" class="panel-container" data-component="panels"></div>

        <!-- Status Bar (bottom edge, 20px) -->
        <div id="status-bar" class="status-bar" data-component="status-bar">
            <span id="status-fps" class="status-item mono" data-element="status-fps">-- FPS</span>
            <span class="status-sep"></span>
            <span id="status-alive" class="status-item mono" data-element="status-alive">0 alive</span>
            <span class="status-sep"></span>
            <span id="status-threats" class="status-item mono" data-element="status-threats">0 threats</span>
            <span class="status-sep"></span>
            <span id="status-ws" class="status-item mono" data-element="status-ws">WS: --</span>
            <span class="status-right">
                <span class="status-item mono">TRITIUM-SC v0.1.0</span>
                <span class="status-sep"></span>
                <kbd class="status-key">?</kbd>
                <span class="status-item">HELP</span>
            </span>
        </div>
    </main>

    <!-- ================================================================== -->
    <!-- TOAST CONTAINER (top-right, for Amy thoughts + alerts)             -->
    <!-- ================================================================== -->
    <div id="toast-container" class="toast-container" data-component="toasts" role="status" aria-live="polite" aria-label="Notifications">
    </div>

    <!-- ================================================================== -->
    <!-- CHAT PANEL (slide-out from right, hidden by default)               -->
    <!-- ================================================================== -->
    <div id="chat-overlay" class="chat-overlay" data-component="chat-overlay" hidden>
        <div id="chat-panel" class="chat-panel" data-component="chat-panel">
            <div class="chat-header">
                <span class="chat-title mono">AMY COMM</span>
                <button id="chat-close" class="chat-close-btn" data-element="chat-close" aria-label="Close chat">
                    <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                        <path d="M4 4L12 12M12 4L4 12" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                    </svg>
                </button>
            </div>
            <div class="chat-context" data-element="chat-context">
                <div class="chat-context-label mono">LATEST THOUGHT</div>
                <div id="chat-context-text" class="chat-context-text" data-element="chat-context-text">--</div>
            </div>
            <div id="chat-messages" class="chat-messages" data-element="chat-messages" role="log" aria-label="Chat messages">
            </div>
            <div class="chat-input-area">
                <input id="chat-input" class="chat-input" data-element="chat-input"
                       type="text" placeholder="Talk to Amy..."
                       autocomplete="off" spellcheck="false"
                       aria-label="Chat message input">
                <button id="chat-send" class="chat-send-btn mono" data-element="chat-send">SEND</button>
            </div>
        </div>
    </div>

    <!-- ================================================================== -->
    <!-- MODAL LAYER                                                         -->
    <!-- ================================================================== -->
    <div id="modal-overlay" class="modal-overlay" data-component="modal" hidden>
        <div id="modal-content" class="modal-content" data-element="modal-content">
            <button id="modal-close" class="modal-close-btn" data-element="modal-close" aria-label="Close modal">
                <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                    <path d="M5 5L15 15M15 5L5 15" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                </svg>
            </button>
        </div>
    </div>

    <!-- ================================================================== -->
    <!-- HELP OVERLAY                                                        -->
    <!-- ================================================================== -->
    <div id="help-overlay" class="help-overlay" data-component="help" hidden>
        <div class="help-panel corner-marks">
            <div class="help-header">
                <span class="help-title">KEYBOARD SHORTCUTS</span>
                <button class="help-close-btn" data-element="help-close" aria-label="Close help">
                    <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                        <path d="M4 4L12 12M12 4L4 12" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                    </svg>
                </button>
            </div>
            <div class="help-body">
                <div class="help-section">
                    <div class="help-section-title mono">GENERAL</div>
                    <div class="help-row"><kbd>?</kbd><span>Toggle help</span></div>
                    <div class="help-row"><kbd>ESC</kbd><span>Close panel / modal</span></div>
                    <div class="help-row"><kbd>C</kbd><span>Open Amy chat</span></div>
                    <div class="help-row"><kbd>/</kbd><span>Focus chat input</span></div>
                    <div class="help-row"><kbd>M</kbd><span>Toggle minimap</span></div>
                </div>
                <div class="help-section">
                    <div class="help-section-title mono">MAP</div>
                    <div class="help-row"><kbd>O</kbd><span>Observe mode</span></div>
                    <div class="help-row"><kbd>T</kbd><span>Tactical mode</span></div>
                    <div class="help-row"><kbd>S</kbd><span>Setup mode</span></div>
                    <div class="help-row"><kbd>F</kbd><span>Center on action</span></div>
                    <div class="help-row"><kbd>R</kbd><span>Reset camera</span></div>
                    <div class="help-row"><kbd>I</kbd><span>Toggle satellite imagery</span></div>
                    <div class="help-row"><kbd>[</kbd> / <kbd>]</kbd><span>Zoom in / out</span></div>
                </div>
                <div class="help-section">
                    <div class="help-section-title mono">PANELS</div>
                    <div class="help-row"><kbd>1</kbd><span>Toggle Amy panel</span></div>
                    <div class="help-row"><kbd>2</kbd><span>Toggle Units panel</span></div>
                    <div class="help-row"><kbd>3</kbd><span>Toggle Alerts panel</span></div>
                    <div class="help-row"><kbd>4</kbd><span>Toggle Game HUD panel</span></div>
                </div>
                <div class="help-section">
                    <div class="help-section-title mono">LAYOUTS</div>
                    <div class="help-row"><kbd>Ctrl+1</kbd><span>Commander layout</span></div>
                    <div class="help-row"><kbd>Ctrl+2</kbd><span>Observer layout</span></div>
                    <div class="help-row"><kbd>Ctrl+3</kbd><span>Tactical layout</span></div>
                    <div class="help-row"><kbd>Ctrl+4</kbd><span>Battle layout</span></div>
                    <div class="help-row"><kbd>Ctrl+Shift+S</kbd><span>Save current layout</span></div>
                </div>
                <div class="help-section">
                    <div class="help-section-title mono">GAME</div>
                    <div class="help-row"><kbd>B</kbd><span>Begin War</span></div>
                </div>
            </div>
        </div>
    </div>

    <!-- ================================================================== -->
    <!-- GAME OVER OVERLAY                                                  -->
    <!-- ================================================================== -->
    <div id="game-over-overlay" class="game-over-overlay" data-component="game-over" hidden>
        <div class="game-over-panel corner-marks">
            <div id="game-over-title" class="game-over-title" data-element="game-over-title">VICTORY</div>
            <div class="game-over-stats">
                <div class="go-stat">
                    <span class="go-stat-label mono">FINAL SCORE</span>
                    <span id="go-score" class="go-stat-value" data-element="go-score">0</span>
                </div>
                <div class="go-stat">
                    <span class="go-stat-label mono">WAVES SURVIVED</span>
                    <span id="go-waves" class="go-stat-value" data-element="go-waves">0</span>
                </div>
                <div class="go-stat">
                    <span class="go-stat-label mono">TOTAL ELIMINATIONS</span>
                    <span id="go-eliminations" class="go-stat-value" data-element="go-eliminations">0</span>
                </div>
            </div>
            <button class="game-btn game-btn-primary mono" data-action="play-again">[ PLAY AGAIN ]</button>
        </div>
    </div>

    <!-- ================================================================== -->
    <!-- Three.js + 3D models (loaded before module entry for global access) -->
    <!-- ================================================================== -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="/static/js/models.js"></script>

    <!-- ================================================================== -->
    <!-- Combat rendering (global functions, loaded before module entry)    -->
    <!-- ================================================================== -->
    <script src="/static/js/war-combat.js"></script>
    <script src="/static/js/war-fx.js"></script>
    <script src="/static/js/war-hud.js"></script>
    <script src="/static/js/war-audio.js"></script>
    <script src="/static/js/war-events.js"></script>

    <!-- ================================================================== -->
    <!-- Entry point: ES6 module                                            -->
    <!-- ================================================================== -->
    <script type="module" src="/static/js/command/main.js"></script>

</body>
</html>
